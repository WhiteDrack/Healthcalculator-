<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Style Master Pro</title>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/face-landmarks-detection"></script>

    <style>
        :root {
            --neon: #00f2fe;
            --accent: #4facfe;
            --dark: #0f172a;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: var(--dark);
            color: white;
            margin: 0;
            padding: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .container { width: 100%; max-width: 400px; }

        /* Header Area */
        .header { text-align: center; margin-bottom: 20px; }
        .header h1 { font-size: 1.5rem; letter-spacing: 2px; color: var(--neon); margin: 0; }

        /* Preview Box */
        #preview-wrap {
            width: 100%;
            height: 380px;
            background: #000;
            border-radius: 30px;
            position: relative;
            border: 2px solid rgba(0, 242, 254, 0.2);
            overflow: hidden;
            box-shadow: 0 0 20px rgba(0, 242, 254, 0.1);
        }

        video { width: 100%; height: 100%; object-fit: cover; }
        
        .scan-line {
            position: absolute; top: 0; left: 0; width: 100%; height: 3px;
            background: var(--neon); box-shadow: 0 0 15px var(--neon);
            animation: moveScan 3s linear infinite; display: none;
        }

        @keyframes moveScan {
            0% { top: 0; } 100% { top: 100%; }
        }

        /* Results Card */
        .result-card {
            background: rgba(255,255,255,0.05);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 15px;
            margin-top: -40px;
            position: relative;
            z-index: 10;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .stats { display: flex; justify-content: space-between; margin-bottom: 15px; }
        .stat-box { text-align: center; flex: 1; }
        .stat-box label { font-size: 10px; color: #888; text-transform: uppercase; }
        .stat-box b { display: block; color: var(--neon); font-size: 14px; }

        /* Voice/Buttons Section */
        .controls { margin-top: 20px; text-align: center; }
        
        .mic-btn {
            width: 60px; height: 60px; border-radius: 50%;
            background: linear-gradient(135deg, #ff4b2b, #ff416c);
            border: none; color: white; font-size: 24px;
            cursor: pointer; transition: 0.3s;
            box-shadow: 0 0 15px rgba(255, 65, 108, 0.4);
        }

        .mic-active { animation: pulse 1s infinite; transform: scale(1.1); }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 65, 108, 0.7); }
            100% { box-shadow: 0 0 0 15px rgba(255, 65, 108, 0); }
        }

        #chat-bubble {
            background: rgba(0,0,0,0.3);
            padding: 12px; border-radius: 15px; font-size: 13px;
            margin-top: 15px; border-left: 3px solid var(--neon);
            min-height: 20px; color: #ddd;
        }

        .main-btn {
            background: var(--neon); color: #000; border: none;
            padding: 12px 25px; border-radius: 10px; font-weight: bold;
            width: 100%; margin-bottom: 10px; cursor: pointer;
        }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>STYLE AI PRO</h1>
    </div>

    <div id="preview-wrap">
        <div class="scan-line" id="scanner"></div>
        <video id="video" autoplay playsinline muted></video>
        <p id="init-text" style="position:absolute; top:45%; width:100%; text-align:center; color:#444;">Click Scan to Begin</p>
    </div>

    <div class="result-card">
        <div class="stats">
            <div class="stat-box">
                <label>Face Shape</label>
                <b id="face-shape">Detecting...</b>
            </div>
            <div class="stat-box">
                <label>Style Suggestion</label>
                <b id="haircut">Scanning...</b>
            </div>
        </div>
        <div id="chat-bubble">Aap mujhse "Mujh par kaun sa haircut suit karega?" pooch sakte hain.</div>
    </div>

    <div class="controls">
        <button class="main-btn" onclick="startSystem()">ðŸ“· START LIVE SCAN</button>
        <button id="micBtn" class="mic-btn" onclick="startListening()">ðŸŽ¤</button>
        <p style="font-size: 11px; margin-top: 8px; color: #666;">Tap mic and ask me anything!</p>
    </div>
</div>

<script>
    const video = document.getElementById('video');
    const scanner = document.getElementById('scanner');
    const bubble = document.getElementById('chat-bubble');
    const micBtn = document.getElementById('micBtn');
    let detector;

    // 1. Initial Setup
    async function loadAI() {
        const model = faceLandmarksDetection.SupportedModels.MediaPipeFaceMesh;
        detector = await faceLandmarksDetection.createDetector(model, {
            runtime: 'mediapipe',
            solutionPath: 'https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh'
        });
        bubble.innerText = "System ready! Ab aap camera shuru karein.";
    }
    loadAI();

    // 2. Camera & Analysis
    async function startSystem() {
        try {
            const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: "user" } });
            video.srcObject = stream;
            scanner.style.display = "block";
            document.getElementById('init-text').style.display = "none";
            
            setInterval(analyzeFace, 1000);
        } catch (e) {
            alert("Camera Permission Required!");
        }
    }

    async function analyzeFace() {
        if (!detector) return;
        const faces = await detector.estimateFaces(video);
        if (faces.length > 0) {
            const kp = faces[0].keypoints;
            const faceW = Math.abs(kp[454].x - kp[234].x);
            const faceH = Math.abs(kp[152].y - kp[10].y);
            const r = faceH / faceW;

            let s = "Oval", h = "Side Part Pompadour";
            if (r < 1.35) { s = "Round"; h = "High Fade with Textured Top"; }
            else if (r < 1.48) { s = "Square"; h = "Buzz Cut or Slick Back"; }

            document.getElementById('face-shape').innerText = s;
            document.getElementById('haircut').innerText = h;
        }
    }

    // 3. Voice Logic (Hindi)
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    const recognition = new SpeechRecognition();
    recognition.lang = 'hi-IN';

    function startListening() {
        recognition.start();
        micBtn.classList.add('mic-active');
        bubble.innerText = "Sunte raheen...";
    }

    recognition.onresult = (e) => {
        micBtn.classList.remove('mic-active');
        const text = e.results[0][0].transcript.toLowerCase();
        handleVoice(text);
    };

    function speak(txt) {
        const msg = new SpeechSynthesisUtterance(txt);
        msg.lang = 'hi-IN';
        window.speechSynthesis.speak(msg);
        bubble.innerText = txt;
    }

    function handleVoice(input) {
        if (input.includes("kaun sa") || input.includes("haircut") || input.includes("cutting")) {
            const shape = document.getElementById('face-shape').innerText;
            const cut = document.getElementById('haircut').innerText;
            if (shape === "Detecting...") {
                speak("Pehle camera scan hone dein.");
            } else {
                speak(`Aapka chehra ${shape} hai. Mere hisab se aap par ${cut} bahut badiya lagega.`);
            }
        } else if (input.includes("namaste") || input.includes("hello")) {
            speak("Namaste! Kaise hain aap? Main aapka AI style expert hoon.");
        } else {
            speak("Kshama karein, main sirf haircut se jude sawalon ka jawab de sakta hoon.");
        }
    }
</script>

</body>
</html>
