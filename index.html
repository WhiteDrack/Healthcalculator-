<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AI Face Haircut Selector</title>
    <script defer src="https://cdn.jsdelivr.net/npm/@vladmandic/face-api/dist/face-api.js"></script>
    
    <style>
        * { box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', sans-serif;
            background-color: #0f0f0f;
            color: white;
            text-align: center;
            margin: 0;
            padding: 10px;
        }
        h1 { font-size: 1.4rem; color: #00d1b2; margin: 10px 0; }
        
        #container {
            position: relative;
            width: 90%;
            max-width: 350px;
            aspect-ratio: 3/4;
            margin: 0 auto;
            border: 2px solid #00d1b2;
            border-radius: 15px;
            overflow: hidden;
            background: #000;
        }

        video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .btn-start {
            background: #00d1b2;
            color: black;
            border: none;
            padding: 12px 25px;
            font-size: 1rem;
            font-weight: bold;
            border-radius: 25px;
            margin: 15px 0;
            cursor: pointer;
        }

        #result-card {
            width: 90%;
            max-width: 350px;
            margin: 15px auto;
            background: #1e1e1e;
            padding: 15px;
            border-radius: 15px;
            border: 1px solid #333;
        }

        .label { color: #888; font-size: 0.8rem; text-transform: uppercase; margin-bottom: 5px; }
        .highlight { color: #00d1b2; font-size: 1.1rem; font-weight: bold; display: block; margin-bottom: 10px; }
        #status { color: #ffdd57; font-size: 0.8rem; }
    </style>
</head>
<body>

    <h1>✂️ AI Haircut Advisor</h1>
    
    <div id="container">
        <video id="video" autoplay muted playsinline></video>
    </div>

    <button class="btn-start" onclick="init()">Camera Shuru Karein</button>
    <p id="status">Pehle button dabayein...</p>

    <div id="result-card">
        <div class="label">Face Shape</div>
        <span id="face-shape" class="highlight">Scanning...</span>
        
        <div class="label">Recommended Haircut</div>
        <span id="haircut-style" class="highlight">-</span>
    </div>

    <script>
        const video = document.getElementById('video');
        const status = document.getElementById('status');

        async function init() {
            status.innerText = "Models load ho rahe hain, thoda intezar karein...";
            
            // Models loading from a reliable CDN
            const MODEL_URL = 'https://raw.githubusercontent.com/justadudewhohacks/face-api.js/master/weights/';
            
            try {
                await faceapi.nets.tinyFaceDetector.loadFromUri(MODEL_URL);
                await faceapi.nets.faceLandmarks68Net.loadFromUri(MODEL_URL);
                
                status.innerText = "Camera access maanga ja raha hai...";
                startVideo();
            } catch (err) {
                status.innerText = "Error: Models load nahi ho paye. Internet check karein.";
                console.error(err);
            }
        }

        function startVideo() {
            navigator.mediaDevices.getUserMedia({ 
                video: { facingMode: "user" } 
            })
            .then(stream => {
                video.srcObject = stream;
                status.innerText = "AI Active! Face ko frame mein laayein.";
                detectFace();
            })
            .catch(err => {
                status.innerText = "Camera access denied or not found.";
            });
        }

        async function detectFace() {
            const canvas = faceapi.createCanvasFromMedia(video);
            document.getElementById('container').append(canvas);
            const displaySize = { width: video.offsetWidth, height: video.offsetHeight };
            faceapi.matchDimensions(canvas, displaySize);

            setInterval(async () => {
                const detection = await faceapi.detectSingleFace(video, new faceapi.TinyFaceDetectorOptions()).withFaceLandmarks();
                
                if (detection) {
                    const landmarks = detection.landmarks;
                    const jawline = landmarks.getJawline();
                    
                    // Simple Calculation for Face Shape
                    const jawWidth = Math.abs(jawline[0].x - jawline[16].x);
                    const faceHeight = Math.abs(jawline[8].y - landmarks.getPositions()[27].y);
                    const ratio = faceHeight / jawWidth;

                    let shape = "Checking...";
                    let style = "Scanning...";

                    if (ratio > 1.5) {
                        shape = "Oval (Andakar)";
                        style = "Side Part, Pompadour, ya Fringe";
                    } else if (ratio < 1.3) {
                        shape = "Round (Gol)";
                        style = "High Fade, Spiky Hair, ya Quiff";
                    } else {
                        shape = "Square (Chaukore)";
                        style = "Buzz Cut, Crew Cut, ya Slicked Back";
                    }

                    document.getElementById('face-shape').innerText = shape;
                    document.getElementById('haircut-style').innerText = style;
                }
            }, 1000);
        }
    </script>
</body>
</html>

